<?php

include("inc/login_query.php");


?>
<!DOCTYPE html>
<html>
    <head>
        <title>LogIn</title>
        <link rel="stylesheet" type="text/css" href="main.css">
    </head>
    <body>

  <?php


define (DB_USER, "root");
define (DB_PASSWORD, "root");
define (DB_DATABASE, "test");
define (DB_HOST, "localhost");


$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_DATABASE);


?>
<!DOCTYPE html>
<html>
<head>


    <title>PHP mysql confirmation box before delete record using jquery ajax</title>


</head>


<body>
<div class="container">
    <h3 class="text-center">PHP mysql confirmation box before delete record using jquery ajax</h3>
    <table class="table table-bordered">
        <tr>
            <th>Name</th>
            <th>Email</th>
            <th width="100px">Action</th>
        </tr>


 <?php


        require('db_config.php');


        $sql = "SELECT * FROM users";
        $users = $mysqli->query($sql);


        while($user = $users->fetch_assoc()){


        
?>

            <tr id="<?php echo $user['id'] ?>">
                <td><?php echo $user['name'] ?></td>
                <td><?php echo $user['email'] ?></td>
                <td><button class="btn btn-danger btn-sm remove">Delete</button></td>
            </tr>


       


    </table>
</div> <!-- container / end -->





<script type="text/javascript">
    $(".remove").click(function(){
        var id = $(this).parents("tr").attr("id");


        if(confirm('Are you sure to remove this record ?'))
        {
            $.ajax({
               url: '/delete.php',
               type: 'GET',
               data: {id: id},
               error: function() {
                  alert('Something is wrong');
               },
               success: function(data) {
                    $("#"+id).remove();
                    alert("Record removed successfully");  
               }
            });
        }
    });


</script>
<?php 
require('db_config.php');


if(isset($_GET['id']))
{
     $sql = "DELETE FROM users WHERE id=".$_GET['id'];
     $mysqli->query($sql);
 echo 'Deleted successfully.';
}


?>


    </body>

</html>
